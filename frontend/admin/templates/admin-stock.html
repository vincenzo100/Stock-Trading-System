<html>
    <head>
        <meta charset="utf-8">
        <title>KVB Stocks - Admin Login Page</title>
        <link rel="stylesheet" href="admin-login-layout.css">
        <link rel="stylesheet" href="admin-login-styles.css">
        <link rel="stylesheet" href="/User Webpages/nav-bar.css">
    </head>
    <header>
        <table class="logo">
            <td>
                KVB Stocks
            <td>
        </table>
    </header>
    <body>
        <div class="description">
            <p>
                Log into your KVB Admin Portal
            </p>
        </div>
        <div class="credentials">
            <form>
                <div class="epass">
                    <label for="email">email*</label><br>
                </div>
                    <input type="email" id="email" name="email" required><br>
                <div class="epass">
                    <label for="password">password*</label><br>
                </div>    
                    <input type="password" id="password" name="password" required><br>
                <div class="submit">
                    <input type="submit" value="login" formaction="admin-dash.html">
                </div>    
                </form>
        </div>
        <div class="bottom">
            <p>
                Are you a customer? <a href="/User Webpages/user-login.html">Login here</a>
            </p>
        </div>
    </body>

<script>
const API_BASE_URL = "https://stock-trading-system-production.up.railway.app/api/";  // Define API base URL

// Listen for form submission to send data to Django API
document.getElementById("stockForm").addEventListener("submit", function(event) {
    event.preventDefault();
    
    const company = document.getElementById("company").value;
    const ticker = document.getElementById("ticker").value;
    const initialPrice = document.getElementById("initial").value;

    fetch(`${API_BASE_URL}stocks/add/`, {  // Uses base URL dynamically
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            company_name: company,
            ticker: ticker,
            price: parseFloat(initialPrice),
            volume: 1000
        })
    })
    .then(response => response.json())
    .then(data => {
        alert("Stock added successfully!");
        document.getElementById("stockForm").reset();  // Clears form after submission
    })
    .catch(error => console.error("Error adding stock:", error));
});
</script>

</html>
