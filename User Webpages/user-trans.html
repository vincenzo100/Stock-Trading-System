<html>
    <head>
        <meta charset="utf-8">
        <title>KVB Stocks - Transaction History</title>
        <link rel="stylesheet" href="user-trans-layout.css">
        <link rel="stylesheet" href="user-trans-styles.css">
    </head>
    <header>
        <table class="logo">
            <td><a class="logo" href="user-dash.html">KVB Stocks</a></td>
        </table>
        <table class="nav">
            <td><a href="user-trans.html">Transactions</a></td>
            <td><a href="user-port.html">Portfolio</a></td>
            <td><a href="user-login.html">Log Out</a></td>
        </table>
    </header>
    <body>
        <table class="title">
            <td>Transaction History</td>
        </table>
        <div class="bod">
            <table class="header">
                <tr><th>Date</th><th>Type</th><th>Stock</th><th>Shares</th><th>Amount</th></tr>
                <tbody id="transaction-list"></tbody> <!-- Transactions will be inserted here -->
            </table>
        </div>
        <script>
        document.addEventListener("DOMContentLoaded", function() {
            const token = localStorage.getItem("token");

            fetch("https://stock-trading-system-production.up.railway.app/api/getTransactions/", {
                headers: { "Authorization": `Bearer ${token}` }
            })
            .then(response => response.json())
            .then(data => {
                let transactionList = "";
                data.transactions.forEach(transaction => {
                    transactionList += `<tr>
                        <td>${transaction.timestamp}</td>
                        <td>${transaction.transaction_type}</td>
                        <td>${transaction.stock_ticker}</td>
                        <td>${transaction.quantity}</td>
                        <td>$${transaction.price_at_transaction.toFixed(2)}</td>
                    </tr>`;
                });
                document.getElementById("transaction-list").innerHTML = transactionList;
            })
            .catch(error => console.error("Error fetching transactions:", error));
        });
        </script>
    </body>
</html>
